ServerName sp01.clinnection.local

<IfModule mod_headers.c>
  Header set Cache-Control "no-cache, no-store, must-revalidate"
  Header set Pragma "no-cache"
  Header set Expires 0
</IfModule>

<IfModule mod_ssl.c>
    <VirtualHost _default_:443>
        ServerAdmin webmaster@localhost
        
        DocumentRoot /var/www/ui/v1
        
        <Location "/">
            AuthType shibboleth
            ShibRequestSetting requireSession 1
            require shib-session
        </Location>
        
        <Location /api/v1>
            AuthType shibboleth
            ShibRequestSetting requireSession 1
            require shib-session
            ProxyPass          "http://app01.clinnection.local:8800"
            ProxyPassReverse   "http://app01.clinnection.local:8800"
            RequestHeader add User-cn   %{User-cn}e
            RequestHeader add User-uc   %{User-uc}e
            RequestHeader add Group-Id  %{Group-Id}e
        </Location>

        <Location /api/v2>
            AuthType shibboleth
            ShibRequestSetting requireSession 1
            require shib-session
            ProxyPass          "http://app02.clinnection.local:8080"
            ProxyPassReverse   "http://app02.clinnection.local:8080"
            RequestHeader add User-cn   %{User-cn}e
            RequestHeader add User-uc   %{User-uc}e
            RequestHeader add Group-Id  %{Group-Id}e
        </Location>

        <Location "/iam/protected/">
            AuthType shibboleth
            ShibRequestSetting requireSession 1
            require shib-session
            ProxyPass          "http://iam01.clinnection.local:8090/iam/protected/"
            ProxyPassReverse   "http://iam01.clinnection.local:8090/iam/protected/"
            RequestHeader add User-cn   %{User-cn}e
            RequestHeader add User-uc   %{User-uc}e
            RequestHeader add Group-Id  %{Group-Id}e
        </Location>
        
        ErrorLog ${APACHE_LOG_DIR}/error.log
        CustomLog ${APACHE_LOG_DIR}/access.log combined
        
        SSLEngine on
        
        SSLCertificateFile /certs/sp01.crt
        SSLCertificateKeyFile /certs/sp01.key
        SSLCACertificateFile /certs/ca.crt
        
        <FilesMatch "\.(cgi|shtml|phtml|php)$">
            SSLOptions +StdEnvVars
        </FilesMatch>
        <Directory /usr/lib/cgi-bin>
            SSLOptions +StdEnvVars
        </Directory>
        
    </VirtualHost>
</IfModule>
